<?php

// ãƒ‡ãƒ¼ã‚¿å—ã‘å–ã‚Šã€€ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
// var_dump($_GET);
// exit();
$id = $_GET['id'];
//â‡’read.phpã§a hrefã®ã¨ã“ã§ã€?id={$record["id"]}ã®ã‚ˆã†ã«
//idã‚’è¨­å®šã—ã¦ã„ã‚‹ï¼†
//GETã¯URLã«è¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ï¼ˆPOSTã¯URLãŒéš ã‚Œã‚‹ï¼‰
//ã“ã“ã§GETã™ã‚‹ã¨idã‚’å–ã‚Œã‚‹

// DBæŽ¥ç¶šã€€ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
include('functions.php');
$pdo = connect_to_db();

// ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ã€€SQLå®Ÿè¡Œã€€ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼

// -- WHEREã§æŒ‡å®šã—ãªã„ã¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ãŒå…¨æ»…ã™ã‚‹ï¼ï¼ï¼ˆãƒ‡ãƒªãƒ¼ãƒˆã—ãŸå¾Œã¯æ°¸ä¹…æ¬ ç•ªï¼ï¼‰
// -- DELETEã™ã‚‹ã¨å¾©æ—§ã§ããªã„ã®ã§æ³¨æ„ï¼ï¼ðŸ‘‡ã“ã“ï¼
$sql = 'DELETE FROM todo_table WHERE id=:id';

// ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ã€€è£œè¶³ã€€ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
// ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†ãªã©ã‚’ã™ã‚‹æ™‚ã¯ã€è«–ç†å‰Šé™¤ã—ãŸæ–¹ãŒã„ã„ï¼
// ãƒ‡ãƒªãƒ¼ãƒˆã®é …ç›®ã‚’ MyAdminã€€ã§ NULL ã«ã—ã¦ã€å‰Šé™¤ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ãã“ã«å‰Šé™¤ã—ãŸæ—¥æ™‚ãŒå…¥ã‚‹ã‚ˆã†ã«ã™ã‚‹
// SQLã‚’å®Ÿè¡Œã™ã‚‹ã¨ã“ã‚ã«ã€€IS NULL ã‚’è¿½åŠ ã™ã‚‹ã€‚
// ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
// --- ãƒ¡ãƒ¢ ---
// -- DELETEæ–‡ã®åŸºæœ¬æ§‹é€ 
// DELETE FROM ãƒ†ãƒ¼ãƒ–ãƒ«å;

// -- ä¾‹

// -- å…¨æ¶ˆåŽ»
// DELETE FROM todo_table;
// -- æŒ‡å®šãƒ‡ãƒ¼ã‚¿ã®ã¿
// DELETE FROM todo_table WHERE id = 2;
// ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼

$stmt = $pdo->prepare($sql);
$stmt->bindValue(':id', $id, PDO::PARAM_STR);

try {
  $status = $stmt->execute();
} catch (PDOException $e) {
  echo json_encode(["sql error" => "{$e->getMessage()}"]);
  exit();
}

header("Location:todo_read.php");
exit();

